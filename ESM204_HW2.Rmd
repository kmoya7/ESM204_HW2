---
title: "ESM204_HW2"
author: "Katheryn Moya & Nickolas McManus"
date: "4/15/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(tidyverse)
library(equatiomatic)
library(broom)
```

```{r cars}
# read in data
water_districts <-read_csv(here("water_districts.csv"))
```

```{r}
# for each irrigation district, plot the marginal abatement cost data

## Kern County
ggplot(data = water_districts, aes(x = Reduction, y = MC_Kern)) +
  geom_smooth()+
  labs(title = "Kern County Marginal Abatement Costs",
         x = "quantity of reduction",
         y = "Marginal cost") +
  theme_bw()

## Mojave County
ggplot(data = water_districts, aes(x = Reduction, y = MC_Mojave)) +
  geom_smooth()+
  labs(title = "Mojave County Marginal Abatement Costs",
         x = "quantity of reduction",
         y = "Marginal cost") +
  theme_bw()

## Antelope County
ggplot(data = water_districts, aes(x = Reduction, y = MC_Antelope)) +
  geom_smooth()+
  labs(title = "Antelope County Marginal Abatement Costs",
         x = "quantity of reduction",
         y = "Marginal cost") +
  theme_bw()

## Ventura County
ggplot(data = water_districts, aes(x = Reduction, y = MC_Ventura)) +
  geom_smooth()+
  labs(title = "Ventura County Marginal Abatement Costs",
         x = "quantity of reduction",
         y = "Marginal cost") +
  theme_bw()
```

```{r}
# Linear regression model
kern_lm <- lm(Reduction ~ MC_Kern, data = water_districts)
summary(kern_lm)
kern_tidy <- tidy(kern_lm)
kern_tidy

mojave_lm <- lm(Reduction ~ MC_Mojave, data = water_districts)
summary(mojave_lm)
mojave_tidy <- tidy(mojave_lm)
mojave_tidy

antelope_lm <- lm(Reduction ~ MC_Antelope, data = water_districts)
summary(antelope_lm)
antelope_tidy <- tidy(antelope_lm)
antelope_tidy

ventura_lm <- lm(Reduction ~ MC_Ventura, data = water_districts)
summary(ventura_lm)
ventura_tidy <- tidy(ventura_lm)
ventura_tidy

```

```{r}
ggplot(data = water_districts, aes(x = Reduction,  y = MC_Kern)) +
  geom_point(size = 2) +
  geom_smooth(method = "lm")
             

ggplot(data = water_districts, aes(x = Reduction,  y = MC_Mojave)) +
  geom_point(size = 2) +
  geom_smooth(method = "lm")
             
ggplot(data = water_districts, aes(x = Reduction,  y = MC_Antelope)) +
  geom_point(size = 2) +
  geom_smooth(method = "lm")
             
ggplot(data = water_districts, aes(x = Reduction,  y = MC_Ventura)) +
  geom_point(size = 2) +
  geom_smooth(method = "lm")
             
```
Take zero-intercept and slope of curves to create marginal abatement curves

- Slope: Kern = 0.4302442, Mojave = 0.2559085, Antelope = 0.3331096, Ventura = 0.4703622 (all positive - demand curve is negative)
- We are provided with E0 (baseline): Kern = 150 AF, Mojave = 140 AF, Antelope = 220 AF, Ventura = 245 AF

- Derive demand curve from MA curve and plot all 4 onto the same graph -> learned how to do that in class #7
 --- MB_Kern = 64.5 - 0.43E
 --- MB_Mojave = 36.4 - 0.26E
 --- MB_Antelope = 72.6 - 0.33E
 --- MB_Ventura = 115.15 - 0.47E
```{r}
# Plot all 4 demand curves onto the same graph

MB_Kern <- function(x) {64.5 - 0.43*x}
MB_Mojave <-  function(x) {36.4 - 0.26*x}
MB_Antelope <- function(x) {72.6 - 0.33*x}
MB_Ventura <- function(x) {115.15 - 0.47*x}

ggplot() + 
  xlim(0,250) + 
  labs(title = "Marginal Benefit Curve", x = "Emissions", y = "$/Emissions", color = "Water Districts") +
  geom_function(fun = MB_Kern , aes(color = "blue")) +
  geom_function(fun = MB_Mojave, aes(color = "yellow")) +
  geom_function(fun = MB_Antelope, aes(color = "green")) +
  geom_function(fun = MB_Ventura, aes(color = "purple")) 

#evaluate scenarios
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
